The root cause of CVE-2017-8393 in the Binary File Descriptor (BFD) library, as distributed with GNU Binutils 2.28, centers around an erroneous assumption in how relocation sections are named. Specifically, the library assumed that sections of types SHT_REL and SHT_RELA would always be prefixed with ".rel" or ".rela" respectively. This assumption is baked into the functionality of tools like objcopy and strip, which rely on the libbfd library to interpret and manipulate binary programs. Because of this incorrect assumption, when these tools encounter relocation sections not following this naming convention, they experience a buffer over-read error. This error happens because the tools attempt to access parts of a buffer based on the expected names, leading to access beyond the allocated memory region when the actual section names do not fit this expectation. Consequently, this can cause the tools to crash due to trying to read invalid memory locations.

The supplied patch addresses this issue by modifying the handling and assumptions around the names of relocation sections. It removes the hardcoded expectation of ".rel"/".rela" prefixes and refactors the way relocation sections are identified and processed. The patched code includes changes to function prototypes and implementations to base the relocation section handling more on the actual contents and less on naming conventions. This approach involves dynamically determining the section to which relocations apply based on actual data rather than merely by name prefixes, making the process more robust against non-standard section names and thus mitigating the risk of buffer over-read errors.

In summary, the root cause of CVE-2017-8393 is a flawed assumption about section name formatting in the libbfd library, leading to unsafe memory access patterns that the patch corrects by refining how relocation sections are identified and processed.
